# 开发指南

### 1. 代码结构

```shell
QuantTrading/
├── base/                  # 基础公用的代码（跨模块/服务复用）
│   ├── common/            # 通用组件（线程池、无锁结构等）
│   ├── data_types/        # 通用数据结构（Tick、Order等）
│   ├── utils/             # 工具函数（时间、加密、网络等）
│   └── interfaces/        # 跨模块接口定义
├── core/                  # 核心交易层（进程内模块）
│   ├── event_bus/         # 事件总线模块
│   ├── market_data/       # 行情处理模块（含数据源插件接口）
│   ├── strategy/          # 策略引擎模块（含策略插件接口）
│   ├── oms/               # 订单管理模块
│   ├── ems/               # 执行管理模块（含执行插件接口）
│   ├── account/           # 账户持仓模块
│   └── risk/              # 实时风控模块
├── plugins/               # 可插拔组件（独立编译为动态库）
│   ├── data_sources/      # 数据源插件（CTP、Binance等）
│   ├── strategies/        # 策略插件（趋势跟踪、套利等）
│   └── executors/         # 执行适配器插件（各交易所接口）
├── services/              # 支撑微服务（独立部署）
│   ├── config_service/    # 配置中心服务
│   ├── history_data/      # 历史数据服务
│   ├── logging_service/   # 日志服务
│   ├── monitoring/        # 监控告警服务
│   └── backtest/          # 回测引擎服务
├── api/                   # 接入层代码
│   ├── gateway/           # API网关
│   └── console/           # 前端控制台
└── release/               # 发行配置
    ├── ci/                # CI/CD配置
    ├── deploy/            # 部署脚本
    └── docs/              # 系统文档
```



### 2. 关键设计细节

- **共享基础代码管理**：`base/`目录存放跨模块复用的代码（如统一的`TickData`结构体），避免重复开发和确保数据格式一致。
- **插件的独立编译**：`plugins/`目录下的组件编译为动态库（.so/.dll），核心模块通过插件接口动态加载，实现 “代码在同一仓库，运行时解耦”。
- **核心模块与微服务的代码隔离**：通过目录明确区分，但在同一仓库内，便于跨模块修改（如`core/market_data`的接口变更可同步修改`services/history_data`的适配代码）。
- **微服务的独立部署**：`services/`目录下的每个子目录包含独立的`Dockerfile`和部署配置，支持单独构建镜像和部署，不影响其他服务。



### 3. 过渡期策略

如果未来系统规模扩大（如微服务增至 10 个以上，团队拆分独立维护），可从单体仓库逐步拆分：

- 先将成熟且独立的微服务（如日志服务、监控服务）拆分到单独仓库；
- 核心交易层和强依赖的微服务（如历史数据服务）仍保留在主仓库；
- 通过 “git submodule” 或 “包管理工具”（如 CMake 的`FetchContent`）管理仓库间的依赖。

